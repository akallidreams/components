{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport { useState } from \"react\";\nexport var useMyForm = function useMyForm(_ref) {\n  var _ref$initialState = _ref.initialState,\n      initialState = _ref$initialState === void 0 ? {} : _ref$initialState,\n      _ref$schema = _ref.schema,\n      schema = _ref$schema === void 0 ? {} : _ref$schema;\n\n  var _useState = useState(initialState),\n      _useState2 = _slicedToArray(_useState, 2),\n      formData = _useState2[0],\n      setFormData = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errors = _useState4[0],\n      setErrors = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      submitTouched = _useState6[0],\n      setSubmitTouched = _useState6[1];\n\n  var handleChange = function handleChange(key) {\n    return function (value) {\n      setFormData(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, key, value));\n      });\n    };\n  };\n\n  var handleSubmitForm = function handleSubmitForm(callback) {\n    setSubmitTouched(true);\n    handleValidation();\n    return callback(formData);\n  };\n\n  var handleValidation = function handleValidation() {\n    schema.validate(formData, {\n      abortEarly: false\n    }).then(function (valid) {\n      setErrors({});\n    }).catch(function _callee(error) {\n      var errors;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              errors = {};\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(error.inner.forEach(function (e) {\n                var path = e.path,\n                    message = e.message;\n                errors[path] = message;\n              }));\n\n            case 3:\n              setErrors(errors);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n  };\n\n  var handleBlur = function _callee2() {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (submitTouched) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 2:\n            handleValidation();\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var register = {\n    onChangeText: handleChange,\n    onBlur: handleBlur,\n    _errors: errors,\n    _formData: formData\n  };\n  return {\n    formData: formData,\n    handleSubmitForm: handleSubmitForm,\n    register: register,\n    errors: errors\n  };\n};","map":{"version":3,"names":["useState","useMyForm","initialState","schema","formData","setFormData","errors","setErrors","submitTouched","setSubmitTouched","handleChange","key","value","prevState","handleSubmitForm","callback","handleValidation","validate","abortEarly","then","valid","catch","error","inner","forEach","e","path","message","handleBlur","register","onChangeText","onBlur","_errors","_formData"],"sources":["/home/danilosilvadev/dev/@akalli/components/src/hooks/useMyForm.ts"],"sourcesContent":["import { useState } from \"react\";\n\nexport const useMyForm = ({ initialState = {}, schema = {} }: any) => {\n  const [formData, setFormData] =\n    useState<{ [key: string]: string }>(initialState);\n  const [errors, setErrors] = useState<{ [key: string]: string }>({});\n  const [submitTouched, setSubmitTouched] = useState<boolean>(false);\n\n  const handleChange = (key: string) => {\n    return (value: string) => {\n      setFormData((prevState) => {\n        return {\n          ...prevState,\n          [key]: value,\n        };\n      });\n    };\n  };\n\n  const handleSubmitForm = (\n    callback: (formData: { [key: string]: string }) => void\n  ) => {\n    setSubmitTouched(true);\n    handleValidation();\n    return callback(formData);\n  };\n\n  const handleValidation = () => {\n    schema\n      .validate(formData, { abortEarly: false })\n      .then((valid: boolean) => {\n        setErrors({});\n      })\n      .catch(async (error: any) => {\n        let errors: { [key: string]: string } = {};\n        await error.inner.forEach((e: any) => {\n          const { path, message } = e;\n          errors[path] = message;\n        });\n        setErrors(errors);\n      });\n  };\n\n  const handleBlur = async () => {\n    if (!submitTouched) return;\n    handleValidation();\n  };\n\n  const register = {\n    onChangeText: handleChange,\n    onBlur: handleBlur,\n    _errors: errors,\n    _formData: formData,\n  };\n\n  return { formData, handleSubmitForm, register, errors };\n};\n"],"mappings":";;;;;;;;AAAA,SAASA,QAAT,QAAyB,OAAzB;AAEA,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,OAA6C;EAAA,6BAA1CC,YAA0C;EAAA,IAA1CA,YAA0C,kCAA3B,EAA2B;EAAA,uBAAvBC,MAAuB;EAAA,IAAvBA,MAAuB,4BAAd,EAAc;;EACpE,gBACEH,QAAQ,CAA4BE,YAA5B,CADV;EAAA;EAAA,IAAOE,QAAP;EAAA,IAAiBC,WAAjB;;EAEA,iBAA4BL,QAAQ,CAA4B,EAA5B,CAApC;EAAA;EAAA,IAAOM,MAAP;EAAA,IAAeC,SAAf;;EACA,iBAA0CP,QAAQ,CAAU,KAAV,CAAlD;EAAA;EAAA,IAAOQ,aAAP;EAAA,IAAsBC,gBAAtB;;EAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAiB;IACpC,OAAO,UAACC,KAAD,EAAmB;MACxBP,WAAW,CAAC,UAACQ,SAAD,EAAe;QACzB,uCACKA,SADL,2BAEGF,GAFH,EAESC,KAFT;MAID,CALU,CAAX;IAMD,CAPD;EAQD,CATD;;EAWA,IAAME,gBAAgB,GAAG,SAAnBA,gBAAmB,CACvBC,QADuB,EAEpB;IACHN,gBAAgB,CAAC,IAAD,CAAhB;IACAO,gBAAgB;IAChB,OAAOD,QAAQ,CAACX,QAAD,CAAf;EACD,CAND;;EAQA,IAAMY,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;IAC7Bb,MAAM,CACHc,QADH,CACYb,QADZ,EACsB;MAAEc,UAAU,EAAE;IAAd,CADtB,EAEGC,IAFH,CAEQ,UAACC,KAAD,EAAoB;MACxBb,SAAS,CAAC,EAAD,CAAT;IACD,CAJH,EAKGc,KALH,CAKS,iBAAOC,KAAP;MAAA;MAAA;QAAA;UAAA;YAAA;cACDhB,MADC,GACmC,EADnC;cAAA;cAAA,iCAECgB,KAAK,CAACC,KAAN,CAAYC,OAAZ,CAAoB,UAACC,CAAD,EAAY;gBACpC,IAAQC,IAAR,GAA0BD,CAA1B,CAAQC,IAAR;gBAAA,IAAcC,OAAd,GAA0BF,CAA1B,CAAcE,OAAd;gBACArB,MAAM,CAACoB,IAAD,CAAN,GAAeC,OAAf;cACD,CAHK,CAFD;;YAAA;cAMLpB,SAAS,CAACD,MAAD,CAAT;;YANK;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CALT;EAaD,CAdD;;EAgBA,IAAMsB,UAAU,GAAG;IAAA;MAAA;QAAA;UAAA;YAAA,IACZpB,aADY;cAAA;cAAA;YAAA;;YAAA;;UAAA;YAEjBQ,gBAAgB;;UAFC;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAnB;;EAKA,IAAMa,QAAQ,GAAG;IACfC,YAAY,EAAEpB,YADC;IAEfqB,MAAM,EAAEH,UAFO;IAGfI,OAAO,EAAE1B,MAHM;IAIf2B,SAAS,EAAE7B;EAJI,CAAjB;EAOA,OAAO;IAAEA,QAAQ,EAARA,QAAF;IAAYU,gBAAgB,EAAhBA,gBAAZ;IAA8Be,QAAQ,EAARA,QAA9B;IAAwCvB,MAAM,EAANA;EAAxC,CAAP;AACD,CAtDM"},"metadata":{},"sourceType":"module"}